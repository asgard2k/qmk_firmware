#include QMK_KEYBOARD_H
#include "split_util.h"
// Each layer gets a name for readability, which is then used in the keymap matrix below.
// The underscores don't mean anything - you can have a layer called STUFF or any other name.
// Layer names don't all need to be of the same length, obviously, and you can also skip them
// entirely and just use numbers.
enum layer_number {
  _QWERTY = 0,
  _LOWER,
  _RAISE,  
  _FUNCTIONS,
  _ADJUST
};

enum custom_keycodes {
  RGB_RST = SAFE_RANGE,
  STR_1,
  STR_2,
  STR_3,
  STR_4,  
  STR_5,   
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  [_QWERTY] = LAYOUT_split_left_space(
  //,------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------.
      KC_ESC,  C_S_T(KC_GRV),                MT(MOD_LCTL|MOD_LSFT|MOD_LALT,KC_1), KC_2,     KC_3,       KC_4,                   KC_5,     KC_6,      KC_7,               KC_8,         KC_9,    KC_0,            KC_MINS,        KC_EQL,          KC_DEL,
  //|---------+-----------------------------+------------------------------------+---------+-----------+-----------------------+---------+-----|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      KC_PSCR, MT(MOD_LCTL|MOD_LALT,KC_TAB), KC_Q,                                KC_W,     KC_E,       KC_R,                   KC_T,                KC_Y,               KC_U,         KC_I,    KC_O,            KC_P,           KC_LBRC,         KC_RBRC,        KC_BSLS,
  //|---------+-----------------------------+------------------------------------+---------+-----------+-----------------------+---------+-----|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      KC_INS,  KC_LSFT,                      KC_A,                                KC_S,     KC_D,       LT(_RAISE,KC_F),        KC_G,                KC_H,               KC_J,         KC_K,    KC_L,            KC_SCLN,        KC_QUOT,         RSFT_T(KC_ENT),
  //|---------+-----------------------------+------------------------------------+---------+-----------+-----------------------+---------+-----|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      KC_PGUP, KC_LSFT,                      LT(_FUNCTIONS,KC_Z),                 KC_X,     KC_C,       KC_V,                   KC_B,                MO(_FUNCTIONS),     KC_N,         KC_M,    RALT_T(KC_COMM), RGUI_T(KC_DOT), RCTL_T(KC_SLSH), KC_UP,          KC_RGUI,
  //|---------+-----------------------------+------------------------------------+---------+-----------+-----------------------+---------+-----|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      KC_PGDN, KC_LCTL,                      KC_LGUI,                             KC_LALT,  MO(_LOWER), LT(_FUNCTIONS,KC_BSPC),                      LT(_RAISE, KC_SPC), LSFT(KC_F10),                                            KC_LEFT,         KC_DOWN,       KC_RIGHT
  //`------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------'
  ),
  
  [_LOWER] = LAYOUT_split_left_space( 
  //,-------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------.
      _______, _______,                      _______,             _______,    _______,        _______,        _______,            _______,      _______,            _______, _______,     _______,         _______,        _______,         _______,
  //|---------+-----------------------------+--------------------+-----------+---------------+---------------+-------------------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      LALT(KC_F4),         _______,    LALT(KC_LEFT),  LALT(KC_RIGHT), LCTL(LSFT(KC_ESC)),               _______,            _______, _______,     KC_LCBR,         KC_RCBR,        _______,         _______,        _______,
  //|---------+-----------------------------+--------------------+-----------+---------------+---------------+-------------------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      _______,             _______,    LCTL(KC_PGUP),  LCTL(KC_PGDN),  _______,                          _______,            KC_LT,   KC_GT,       KC_LBRC,         KC_RBRC,        _______,         _______,
  //|---------+-----------------------------+--------------------+-----------+---------------+---------------+-------------------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      _______,             _______,    _______,        _______,        _______,                          _______,            KC_LPRN, KC_RPRN,      KC_MINS,         KC_EQL,         KC_BSLS,         _______,        _______,
  //|---------+-----------------------------+--------------------+-----------+---------------+---------------+-------------------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      _______,             _______,    _______,        _______,                                          _______,            _______,                                               _______,         _______,        _______
  //`-------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------'
  ),

  [_RAISE] = LAYOUT_split_left_space( 
  //,-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------.
      _______, KC_GRV,                       KC_1,                            _______,      _______,    _______,             _______,   _______,      _______,            _______, _______,      _______,         _______,        _______,         _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, KC_TAB,                       _______,                         _______,      _______,    _______,             _______,                 _______,            KC_PGUP, KC_UP,        KC_PGDN,         _______,        _______,         _______,        _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, KC_CAPS,                      LCTL(KC_BSPC),                   LCTL(KC_DEL), KC_DEL,     _______,             _______,                 KC_HOME,            KC_LEFT, KC_DOWN,      KC_RGHT,         KC_END,         _______,         _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      _______,                         _______,      _______,    _______,             _______,                 MO(_ADJUST),        _______, LSFT(KC_F10), KC_UNDS,         KC_PLUS,        KC_PIPE,         _______,        _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                      _______,                         _______,      _______,    KC_BSPC,                                      KC_SPC,             _______,                                                _______,         _______,        _______
  //`-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------'
  ),  

  [_FUNCTIONS] = LAYOUT_split_left_space(
  //,-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------.
      STR_1,   LCA(KC_DEL),                  KC_F1,                           KC_F2,        KC_F3,      KC_F4,               KC_F5,     KC_F6,        KC_F7,              KC_F8,   KC_F9,        KC_F10,          KC_F11,         KC_F12,          LCA(KC_DEL),
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      STR_2,   _______,                      RESET,                           _______,      _______,    _______,             _______,                 _______,            _______, KC_INS,       _______,         KC_PSCR,        _______,         _______,        _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      STR_3,   _______,                      _______,                         _______,      _______,    _______,             _______,                 _______,            _______, _______,      _______,         _______,        _______,         _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      STR_4,   _______,                      _______,                         _______,      _______,    LCTL(KC_V),          _______,                 _______,            _______, _______,      KC_COMM,         KC_DOT,         KC_SLSH,         _______,        _______,
  //|---------+-----------------------------+--------------------------------+-------------+-----------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      STR_5,   _______,                      _______,                         _______,      _______,    _______,                                      _______,            _______,                                                _______,         _______,        _______
  //`-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------'
  ),  

  [_ADJUST] = LAYOUT_split_left_space(
  //,-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------.
      RGB_TOG, _______,                  RGB_M_P,                    RGB_MODE_GRADIENT,  RGB_M_K,       RGB_MODE_FORWARD,    RGB_M_R,   RGB_M_SW,     _______,            _______, _______,      _______,         _______,        _______,         _______,
  //|---------+-------------------------+---------------------------+-------------------+--------------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, RGB_MOD,                  RGB_RST,                    RGB_VAI,            RGB_HUI,       RGB_SAI,             RGB_SPI,                 _______,            _______, _______,      _______,         _______,        _______,         _______,        _______,
  //|---------+-------------------------+---------------------------+-------------------+--------------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, RGB_RMOD,                 _______,                    RGB_VAD,            RGB_HUD,       RGB_SAD,             RGB_SPD,                 _______,            _______, _______,      _______,         _______,        _______,         _______,
  //|---------+-------------------------+---------------------------+-------------------+--------------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                  _______,                    _______,            _______,       _______,             _______,                 _______,            _______, _______,      _______,         _______,        _______,         _______,        _______,
  //|---------+-------------------------+---------------------------+-------------------+--------------+--------------------+----------+--------|   |--------------------+--------+-------------+----------------+---------------+----------------+---------------+----------|
      _______, _______,                  _______,                    _______,            _______,       _______,                                      _______,            _______,                                                _______,         _______,        _______
  //`-------------------------------------------------------------------------------------------------------------------------------------------|   |------------------------------------------------------------------------------------------------------------------------'
  )
};


int RGB_current_mode;
bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  bool result = false;
  switch (keycode) {
    #ifdef RGBLIGHT_ENABLE
      case RGB_MOD:
          if (record->event.pressed) {
            rgblight_mode(RGB_current_mode);
            rgblight_step();
            RGB_current_mode = rgblight_get_mode();
          }
        break;
      case RGB_RST:
          if (record->event.pressed) {
            eeconfig_update_rgblight_default();
            rgblight_enable();
            RGB_current_mode = rgblight_get_mode();
          }
        break;
    #endif
      case STR_1:
          if (record->event.pressed) 
            SEND_STRING("August13@@");
        break;
      case STR_2:
          if (record->event.pressed) 
            SEND_STRING("taikamng@yahoo.com");
        break;
      case STR_3:
          if (record->event.pressed) 
            SEND_STRING("tai.kam.ng@kla-tencor.com");
        break;
      // case STR_4:
          // if (record->event.pressed) 
            // SEND_STRING("");
        // break;
      // case STR_5:
          // if (record->event.pressed) 
            // SEND_STRING("");
        // break;		
    default:
      result = true;
      break;
  }

  return result;
}

#ifdef OLED_DRIVER_ENABLE

const char *read_logo(void) {
  static char logo[] = {
      0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8a, 0x8b, 0x8c, 0x8d, 0x8e, 0x8f, 0x90, 0x91, 0x92, 0x93, 0x94,
      0xa0, 0xa1, 0xa2, 0xa3, 0xa4, 0xa5, 0xa6, 0xa7, 0xa8, 0xa9, 0xaa, 0xab, 0xac, 0xad, 0xae, 0xaf, 0xb0, 0xb1, 0xb2, 0xb3, 0xb4,
      0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7, 0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf, 0xd0, 0xd1, 0xd2, 0xd3, 0xd4,
      0};
  return logo;
}

oled_rotation_t oled_init_user(oled_rotation_t rotation) {
    return isLeftHand ? OLED_ROTATION_180 : OLED_ROTATION_0;
}

void oled_task_user(void) {
  if (is_keyboard_master()) {
    // Host Keyboard Layer Status
    oled_write_P(PSTR("Layer: "), false);
    switch (get_highest_layer(layer_state)) {
    case _QWERTY:
      oled_write_P(PSTR("Default\n"), false);
      break;
    case _LOWER:
      oled_write_P(PSTR("Lower\n"), false);
      break;
    case _RAISE:
      oled_write_P(PSTR("Rasise\n"), false);
      break;
    case _FUNCTIONS:
      oled_write_P(PSTR("Function\n"), false);
      break;    
    case _ADJUST:
      oled_write_P(PSTR("Adjust\n"), false);
      break;      
    default:
      // Or use the write_ln shortcut over adding '\n' to the end of your string
      oled_write_ln_P(PSTR("Undefined"), false);
    }

    // Host Keyboard LED Status
    led_t led_usb_state = host_keyboard_led_state();
    oled_write_P(led_usb_state.num_lock ? PSTR("NUMLCK ") : PSTR("       "), false);
    oled_write_P(led_usb_state.caps_lock ? PSTR("CAPLCK ") : PSTR("       "), false);
    oled_write_P(led_usb_state.scroll_lock ? PSTR("SCRLCK ") : PSTR("       "), false);
  } else {
    oled_write(read_logo(), false);
  }
}
#endif
